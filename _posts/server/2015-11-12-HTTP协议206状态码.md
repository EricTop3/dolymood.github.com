---
layout: post
category : server
tagline: ""
tags : [http, http range, http content-range, 206状态码]
---
{% include JB/setup %}

之前一直不知道这个是用来干什么用的，面试的时候被问到了，所以就查阅相关文章，这里记下自己的理解。

首先来看206状态码（Partial Content）代表什么意思，来自维基百科：

> 服务器已经成功处理了部分GET请求。类似于FlashGet或者迅雷这类的HTTP 下载工具都是使用此类响应实现断点续传或者将一个大文档分解为多个下载段同时下载。

> 该请求必须包含Range头信息来指示客户端希望得到的内容范围，并且可能包含If-Range来作为请求条件。

> 响应必须包含如下的头部域：

> 1) Content-Range用以指示本次响应中返回的内容的范围；如果是Content-Type为multipart/byteranges的多段下载，则每一multipart段中都应包含Content-Range域用以指示本段的内容范围。假如响应中包含Content-Length，那么它的数值必须匹配它返回的内容范围的真实字节数。
> 2) Date

> 3) ETag和／或Content-Location，假如同样的请求本应该返回200响应。

> 4) Expires, Cache-Control，和／或Vary，假如其值可能与之前相同变量的其他响应对应的值不同的话。

> 假如本响应请求使用了If-Range强缓存验证，那么本次响应不应该包含其他实体头；假如本响应的请求使用了If-Range弱缓存验证，那么本次响应禁止包含其他实体头；这避免了缓存的实体内容和更新了的实体头信息之间的不一致。否则，本响应就应当包含所有本应该返回200响应中应当返回的所有实体头部域。

> 假如ETag或Last-Modified头部不能精确匹配的话，则客户端缓存应禁止将206响应返回的内容与之前任何缓存过的内容组合在一起。
任何不支持Range以及Content-Range头的缓存都禁止缓存206响应返回的内容。

可以看出，206代表的意思也就是响应了部分内容，那肯定就需要有上边解释说的一些消息头来控制怎么通过每次得打部分内容的方式来完成整个的接收。利用的场景也就是对于大文件下载比较多，也就实现了断点续传的功能。

<!--more-->

### 判断是否支持

如果我们不知道一个资源是不是支持206，怎么进行判断呢？或者说不支持的时候，服务器会有什么响应呢？

执行

```
curl -I http://s0.cyberciti.org/images/misc/static/2012/11/ifdata-welcome-0.png
```

得到的结果是：

```

```
