---
layout: post
category : server
tagline: ""
tags : [ssh, sshd, centos, server]
---
{% include JB/setup %}

由于阿里云最近的一次云盾的大功劳引起的悲剧，自己也就不幸成为了其中一个“幸运儿”。可能是因为当时我正在通过ssh连接自己的服务器，然后再通过git拉取代码，但是这一下失败了。悲剧就此发生，再次使用git，md，发现没有git命令了？当时自己就坐在那一个劲的问自己为啥？？

然后我想自己再次重连下自己的服务器看看啥子情况，退出后连接自己的服务器，更大的悲剧发生了，发现自己连接不上去了，这该如何是好？由于当时自己还没有意识到是阿里云的故障问题，以为自己捣鼓坏了呢，然后就去网站上通过终端连接，查看自己服务器状态，进去之后还是发现自己的git、vi啊什么乱七八杂的直接没有了，运行啥就告诉自己没有此命令了！这。。。

然后自己就“机智”的去了论坛，一看，立马知道罪魁祸首了！没有办法，只能干等了。等啊等。。。

<!--more-->

等了将近一天了发现还是不好，论坛中有网友说通过回滚自己的镜像就解决了，OK，不是说滚就滚啊；自己想了下貌似没有增加啥新的东西，然后就果断回滚了，但是我选择的回滚日期是9月1号凌晨3点的多的，心想总没事吧。滚完之后尝试通过ssh连接服务器，发现依旧是失败！我擦！

再次通过网站的终端连接，上去后发现，自己的git、vi啊什么竟然能使用了，看起来一切正常了。看来就差一个ssh的服务了。使用命令`service sshd status`发现提示`openssh-daemon is stopped`，以为通过重启`service sshd restart`可以搞定，但是在stop的时候fail了。这。。只能寄希望Google大神了。看搜索结果第一条 <http://serverfault.com/questions/538037/sshd-service-fails-to-start> 里边有各种解决方案，看作者自己也是各种试验，我自己也是各种试验，发现前面的都不行啊。继续往下看，最后一条，0赞同，但是感觉值得一试啊，所以果断：

```
yum remove openssh

yum install openssh openssh-server openssh-clients

service sshd start
```

试验后果断好了，总算解决了！这或许就是所谓的“万能的重启！”或者“重装！”式解决方案。

至于之前为什么自己不能重启sshd，貌似是因为牛逼的“云盾“删除了服务器上的`/var/run/sshd.pid`，当时在找解决方案的时候，有人遇到的也是这样的没有这个文件，所以就在stop的那一步就失败告终。。

完
